from bokeh.plotting import figure, show, output_file, save
from bokeh.models import Span, BoxAnnotation, HoverTool, ColumnDataSource, Label, LabelSet, CustomJS
from bokeh.colors import RGB
import pyslow5
import copy
import argparse
import re
import numpy as np

KMER_LENGTH = 6
BASE_LIMIT = 1000

base_color_map = {'A': 'limegreen', 'C': 'blue', 'T': 'red', 'G': 'orange'}

parser = argparse.ArgumentParser()

parser.add_argument('-s', '--slow5', required='True', help="shows output")
parser.add_argument('-p', '--paf_read', required='True', help="shows output")
parser.add_argument('-o', '--output', required='True', help="shows output")

args = parser.parse_args()

paf_fields = re.split(r'\t+', args.paf_read)
read_id = paf_fields[0]

print(f'signal file: {args.slow5}')
print(f'read: {read_id}')
print(f'output file: {args.output}')

basecalled_read = "TACTTCGTTCAGTTACGTATTGCTCCTATAATTGAAGACACTTGTTCTTATACTGCTTTAAGGTATAAAGGAAGAAAAAAAACAGATAATGGCAAATGTTGGTGAAGCCGGGCATGGTGGCAGCCTGTAATTCCAGAACTTAGGGAGGCTGAGGTGGGCAGATCACTTGAGGCCAGGAGTATGAGACCAGCCTGGGCAACATGGTAAAATCCCACCACTACAGAAAAATATAAAAATTAGCCAGGCATGGTGGCGTACACCTGTAATTTTCAGCTACCCAGGAGGCTGAGATGAGAGAATCACTTGTGCCTGGGAGGTCACGGCTGCAGTGAACTGTGATGGCATCATTGCACTGCAGCCTGAGAGACAGAGCAAGCCCCTATCTAGAAAAAAAAAATGTCAGTGAAGATGTGGAGGAATTGGAACCCACATACATTACTGGTGGGAACATAAAATTGTGTAACCATTTTGTTTGGGTATTTTCTTTTCTTGTCATTTAGTGGATTTTTAAAAAATCAAGACGGGGTTTCACTATCTTGCCAGGCTGGTCTTGAATTCCTGAGCTCAAGCCATCCTCCTAGCTGAGCCTCCTGAGTAGCTGGGATTACAGGTGTGAGCCATTGCACCCAACTGAGTATAGCCACGTTAGAAAACATTCTGGCAGTTTCTCAAAAGGCTAAATGTACAGTCATCCTATAATGCAACAATTTCACTCCTAGGCATATGTCCAGAAAAATAAAAATATTATGTCCACACAAAAACTTGTACAACAATCTTCATAGCAGCATTATTCATAATGACCAATACATGGAATACATGGAAACAACCCAAATATCCACCAACTGATGAACAGATAAACAAAATGCAGTGTGTCTCTACCATGGAATACTGCCATAGAAGGAATGAAATGATACACACTATGACATAAAGGAACTTTGAAAACACTGTGTAAGAGGGAAAAAAATACAAAAGATCACATATTGTACTGTTCTATTTGTCCAGATTAGGCAAATCTATAGTGACAAAAAAATTAATCAATGGTTGCCTAAGGCTGGGGGCAAAGGTAGGTGGGGAGAGTAGGAGGTAGTGGCTAAGGGGTATGGATTTCTCTATAGGGTAATGAAAGGTTCTAAAAGTGACTGTGGTGATCGATGCACAGCTCTGTGAATATTCTAAAACCTACTGAATTGCAGATTTCAATAAATAAAGTGAATGGTATGTGAATATTTTAATAAAGCTATTATTTAAAATAATAATAATAGGGGGCTGGGCACAGGTGGTCATGCCTGTAATCCCAGCACTTTGGGAGGCTGAGGCAGGAGGATCACTTGAGGTCAGGAGTTTGAGCCCAGTCGGAGCAACATGGCAAGATCCCGTCTCTATGATAAAAAATTACCTGGACATGGTGGCACATGTCTGTAGTCCCAGCTACTTGGGAGACTGAAGTGAGAGAACCACTTGAGCCCAGGAGTTTGAGGCTACAGTGAACCATGATCATGTCATACTGTAGCCTAAGCAACAGAGCAAGACGCTGTCTCTGAAAGGAAAGAAAACAAATGCAAGTTTTTATCACTTTGTGAGTGGCAGCCAAGTTGGAGGAGAAATAGACAATAATAAAAGAGCACTGAATAATGACAGTGAGTGGCTGGTTAGGCTCAGTTGCTAGCTAAATGGCTTCTAGAAATTCAATAAAGTTACAGCTCTGGGGACAGTCATGTAGTCAAAGAATGAGAGCGAAATTCATTACAATTGCCCATGGTCTTTATTTACATGCCTTCTAGTGAAAAATTCTAAGTGCCTAAACAGCAAGTCTGCAATGATAGCAGCTGTTTATTAAAGACTAAAAAAGAAATGGAGGCCGGGCGTGGTTGTTCACATCTGTACTCCCCTTGAATTTTGGGAGGCTGAGGCAGGCAGATTGCCTGAGGTCAGGAGCTCGGGAGCCTGGCCAACATGGTGAAATCCCATCTCTACTAAAAATACAAAAATTAGCTGGGTATGGTGGCGGGCACCTGTAATCCCAGCTACTCGGGAGGCTGAGGCAGGAGAATTGCTTGAACCCAGAAGGTGAAGGTTGCAGTGAGCCAAAATCGCACCATTGCACTCCAGCCTGGGTGACAAGAGAAAGACTCTTATCTTAAAAAAAAAAGAAAAAAAGAAATGGCATCTTCTTCAAGAATTACATCGTGTTTCATGATAAAGCTCTAATTTGCATTTGTTCAAGTATTGATGAATTGCAATATGACACCCATCTTGGATAAAATGCAAACAACACAATTTCATTTTCTCATTAACAAAACCGATTAAGTAGTCTAATATAAATTGCGATCTTATTAAAAACTGATCCGATTTAAAAAATTATGGAATTATGGAGCCAATAAGATGTTACAACCTGTTCAAGGGGAATTCAAAATCCACACATATCTGAGACCATCAAGTATGATGAAATATATTTGATTACTATATTGAAAAATAAACTGATTACATAGCCAACAATTGGACAGGGGTCTCCTCATCCACAGCCACACAAACCCGATCATGCAGCTGTATGGTTACAAAACTCACATAGCCTAGAAGGGACTGGTCTGACTTGAGATTTCATTTGTATTTGTATTTTGAGACAGGGTCCCACTCTGTCACCCAGGATGGAGTGCAGTGGTATAATCATAGCTCACTGCAACCTTGACCAACTGGGCTCAAGAGATGCTCCTGCCTCAGCTGCCCCCATACCTGGGAATACAGGCAAGTATCACCATGTCCAGGCATTTTTTTTTCATTTTGTAGAGAGAGAAGACTTGCTATGTTGCCCAAGCTGGCCTCAAACTCCTAGAATCAAGAGATCTGCCCATCTCAGCCACATGAGTAACTGGGGCCATAGGTACATACCATCATGCCTGGCTATATTTATTTTCTTTTTATTAAATTTATTTTTGTTTGTAGAGGAGGTCTTGCTGTGTTGCCCAGGCTGCTCTCAAACTCATGGCCTTAAAACATACTCCCATCTCCTCTGCCTCTCAAACTGTTGGAACTATAGGTGTGAGCCACTGTACCTGGCCTGACTTGGGATTTCTTTTATCTAGCATCCTTTACTTGGTAGGATTGGGAAAAGCAGTAGTGTTTTTAAAATTACTTAATAATTCAATCAGAATCAAACTCCAACCTTGACCACTGCCTTCTCTCACAGCTCATCCAGTCTGTCAGGAAATCCTACTGACTGACTTCAACATGTATCCAGGCTCTAACCATCTCTCACCACCACCATGAACCCCGTCAGGATCACTATCATCTCCCACCGGGATGTTGCCACAACAGCTCCCATGCTTCTACCCAAATCTTCCATAGTCTTTCTCAACTCGGCAGCCAGGTCGTGCTTTTAAATCAGGAGACGGATCATGTCGCCTCTCTGCTCAAAAACACTCGGTGGTTCCCATTTTAGTCAGAGCAAAAGCCAAAGCCCCAGCAGCGTCCAGGGCTTACGATCTGTACCGATCCCAGCCCAGCAACTCCCTGGCCTCCTCGCTGACTTCGCTCCATCTCTTTGCTCCACTGGCCTCCTTCCAGAGCCTCAGACACACCAAGTTTCCTCTAATGCCTTTATCCTGTTGACTCAGCCTACAATGCTCTTCCCTCAGCACCTTGGCCAGCTCCATCACCTGCTTCAAACTTGCTCAATATTCACTTATGAGGCCAACCCTGACCCCTCTACTTAACACTGCCATCTGTCCCCATTCCCACCATGCTCATTTCTTTCTTTCTTTTTGAAACAAGATCTTGCTTTGTTGCCCAGGCTGGAGTACACTGGTGCAATCACAGCTCACAACAACTTCAACCTCCCAGGCTTAAACAATCCTCCCGCCTCAGCCACCTAGGAACTGAGACTACAGCTGCATGCCACAACATGGCTTTTATTTTTTTTTTTGAGACGGAGTCTCGGTCGCCCAGGCTGAAGTGGGGTGCGATCTTGGCTCACTGCAATGTCTGCCTTTTGGGTTCAAGTGATTCTCTGCCTCCCAAGTAGCTGGGATTACAGGCACCCACCACCACACCTGGCTAATGTTTGTATTTTTAGTAGAGATGGGGTTTCACCATCTTGGCTAGGCTGGTCTTGAACTTCTGACCTCGTGATCCACCCTCCTCGGCCTCCCAAAGTGCTGGGATTACAGGCGTGAGCCACTGCGCCTGGCCTTTAAAAAAATATTTTTTAGACATGAGGTCTCATTATGTTGCCCAGGCTGGTCTTAAGCTCCTGGGCTTAAGCGATCCTCCCACCTCAGCCTCCTAAAGTTCTGGGATTACAGGCGTGAGCAACAGCAGCATGAGGTCCCAGCTTCATGTTTTTGTTGTTGCTACAACAAAGTACCCTACATTTAGTGGCATCAAACACCACAAATCTACCATCTTACAGTTCTGGGAGCCGAAGCCCAACTAGGTCTATTAAGGCTAAAGTCAAGGTGTCAGAGAGGCTGCATTCCTTCTGGGGGAGGCTCTGGGTGGGATGTGCTCCTTTGCCTTTCCAACTACAAGCCACCCCATTCCTTGACTTACCTCGTGACTCCATATTCAAGGCCAGAGTGCAGCATCTTCAAATCTCCCTCTCTGACCTCTTCTTCCATTACCACATCACTTTCTCTAATTCTGACTCTCCTACCTCATTCTCTTATAAAGATCCTTGTGATTGGTGGGTATGGGCTCACATCTGTAATCCCAACATTTTGGGAGGCCAAAGAGGAAGGATTGCTTGAGGCCAAGAGTTAGAGATCAGCCTGGGGAAAATAGGAAGATCCTGCCTTTACAAAAATTAAAAATCAGCTGGACATGGTGATGCATGCCTGTAGTTCCAGCTACTGGAGAGGCTAAGGTGGGAGGATTGCTTTAGCCTAGGAGGTCAAGGCTGCAGTGAGCTATGATCACATCACTGCACTCCAGCCTCAGTGGCAGAGTGAGACTCTGTCTCCGATATAAGAAAGAAATATACATTTGGTCTCTGCCCCTGGTTCCTGGCATAGAGCTTCCAAAGCTCTTATAAAGCCCTTCGTGACAGAGGTAATAGGAGCATTTTCTGTTTGATATTTAGTCTTAGTCCCAGGTTCCTGACACAAGGGCCTCTAAGGTCTTTCAGATCTGCAGCATGGTAAGAATGCATGTGGGATGCTGTTGAGCTAACGGGGTGGCTGCAAGCTCCGAGACTGCTTCAGGAGGAGGGCTAGCTGCCAGAAAGCAGCACATTTTTTTTTTAAAACAGAGGTTTGGCTCTTGTAGCCCAGGCTGGAGTGCAATGGCACAATCTCAGCTCGCTACAACCTCCACCTCCCGGGTTCAAGCAATTCTCCTGCCTCGGCCTCCCGAGTAGCTGGAATTATAGGGGTGTGCCACAATGCCTAGCTAACTGTTGTTATTTTTAGTAGAAACAGGGTTTCACCATGTTGGTCAGGCTGGTCTCAAACTCTTGACCTCAAGTGGTCCATGTGCCTCAGCCTTCCAAACTGCTAGGATTACAGGAGTGAGCCACCGCACCTGGCCCCAACCACATTTTTGGGGCTTGGAACTTTCAGCCTCACCTGCTGAACTCCAGGAGGCAAAGGGAACTGGAGATTGACTTAACTACCAATGGCCAGTGATTTTATCAATCATGCCTCCATAAACACCCAAACAGCAGGGTTTGGAAACTTCTGTGTTGCTAAGCCTAGGAGGTCCTGGGAGGGTAGTGTGCCCAACAGAGGGCATGGAAGCTCTGTGCCCCTCCCCACTTACCTTGTCCTGTGCATCTCTCTTTCATTGGCTGTTCCTGAGATGGAGCCATTACATTGAGCCAGTAATAGAAAATAAGGTGGCCAGATGCACTGGCTCATGCCCGTAATCCCAGCACTTTGGGAGGCAGAGGTGGGCGGAATCACTTGAGCCTAGGAATTTGAGACCAACCTGGGCAACATAAGAAGACCCCATCTATACAAAAAATAAAATTAGCCAAATGTGGTGGTGGGAACCCTGTAATTCCAGCTACTTGAGAGGCTGAAGCAGGAGAATCACTTGAGCCCTGGATGTTGAGGCTTCAATAAGCTATGATTGCACCACTGCACACCAGCTTGGACAACAGAGCGAGGCCCTGTCTCTTAAAAAGAAAAGAAAAAAAACTTGTTTTTCTAAGTTCTGTGAGTTGTTCTAGTAAATAATTAAACTCAACAAGAGGGTCATGGGAAACCCTGATTTCTAACTGGTTGGTCAAAATACAGGTGACAGCCTAGGACTTGCAACTGGCATCTGAAGTGAGGTGGTCTTGTGGGACTGAGCCCCTAACCTGTGGGTTCTGTGCTAACTCTAGGTAGTGTGAATGGAATTGTGGGATACGGTTGGCATCCAGAGAGTTGGAGAACTGGTGACAGGAAACTCTGCACACACATTTGGTCAGAAGTCTGTGAGTAGAGAGAAACGTGTTGCAGAAGTCAGGACCCCAAACGGAGGGACTGGCTGAAGCCACGAAGAATATAAATTGTGAAGATTTCATGGACATTTTATTAGTTCCCAAATTAATACTTCTATAATTTCTTAGGCCTGTCATTGCTGCAATCTCTGAACATAAATTGTAATTTCATGAACCTTATCCTTCCCAATCAATACCACTAATTTTCTATACCTGTCTTTAATCTCTTAATCCGCTCATCTTCGTAAAACAGGGATGAATGTCGCAGGACCCTGTGATAATTAGATTAGCTGCAAGTTGTTTAAACAATATAGAAACTGGCACCTTAGAAAGAACAGGATAACAACAATTTCAGGAACAAGGCAACACTAAACTCTAGCTACCTGTAGGCAGGTTGAACAAGGCCATATTCTCTTCTTTCAAAAGCAAATAGGAGAAGTATTGCTGAATTCTTTTTCTCAACTTAAGGCATCCCTGAAAAGGAGAATACATCTAAAGGCACAAATAGCCGCTTTGAGGCAACTGTCTTTTACAGTCATAGATAAGGGATGAAATAAGCCCTAGAGATTGGCGTGTAGCTCCCGGGCTTATCAGAACAAGGGAAATTTAAAACACAATAAAATGTTGGTCAGATGGGTTGTCTGCTCTCAAACCCTTTCTCCTGATAGATGTTATCAATGACAATGCGCGCCCGAAACTTCATTAGCAATTTGTTCCGCTTCCCCAGTCCTGTGGTCCTGTGATCTTGCCCTGCCTCCATTTGCCTTGTGATATTTTATTACCTTGAAGCATGTGATCTCTGTGACCCACACCCTATTCGTACACTCCCTCACCTTTTTGAAAATCACTAATAAAAACTTGTTGGTTTTGCGGCTTGGGGGGCATCACGGAACCTGCCGACGTGTGATGTCTCCCCTGGACATCCAGCTTTAAAATTTCTCTCTTTGTACTCTTTCCCTTTATTTCTCAGACTGGCTGACACTCAGGGAAAATGAAAAGAACCACCATGAAATATCAGGGGTGAATTTCCCCCGATATCACACTGGCTCTTCTCACCTGTCTACCTGCTTAACTTAATAGGAGAGGCAATGCATGGTGCTCATGAACAAGGCAAGCATTAAGAGTCAGACCAGACTAACATTTGACTCAGTCCTAATATTCAGGTGAGCTTGGGCAAATCGCTCATTAACCCCAAGTCTTCATCATTTTGTGCATATAATGGGGATAACTGTGGCACCCACCTGTTTTTGTGAGAATCAATGAAATATTATGCTTGATGTTATTGTGATCACTATCTGACAAGGGCAGTGATGCATGATAACATCAAAATTAGAAACTGTAATGAGGTCTCTTGGGCAAAATTCCATACAGGCAAATTACTGTCTCTACAAAGCATTTCTGCCACACTTAATTCACCATACCCTGAACAAAATGTGCCATCTTCATTGTTCAGGTCTGTATAGTGCTGGTTTCCCTGCCTGGGCAGCTCCTCCATCCATCCCAGCCCAATCCCATCCCTCCACCTCCCCTTCCCTCCCCACTCTCATACAACTCTTCCTTATCTTACGGGACTTGGCTTCAATGTCACCTTAACTTTGGAAAGCTTCTCTCCCTCTCCAGAAAATTCCGATTGCACTTGATGCATGCACTATTATTTGATCATTTTTGAGTTACAGTCCAAGTCTTTTTGTGCCTGAATAACATGTTGCCCAGTCAGTTTCTCTTCCTGGATTCAGAAGTCTTTCATGGTAGGTCCAGCTAGAAGTGACAAAAAGACATTTAAAAAAAAAAAAAAAGAGGGATGACACAGACAGACATCAGCACTTAAAAGTTTTAAACGATATGTGAAAAACAAAATTTAAGGGCTTCTAGGAGAAATGTAGGAGGGAAGGTGTTACTGGGAAATATGATAGAAGGTTAATTTTATTTTATTTTATTTTTAGAGAAAGGGTCTTGCTCTATCACCTAGGCTGGACTGCAGTGGTGCAATCACAGTTAACTGCAGCCTCAACCTCCAGGGCTTGAGGCAATATTCCCATCTAATTTTTATTTTGTTTAAGAAATGCAGTCTTGCTCTTAGCAAAGCTAAAGTGCAATGGTGTGATCATAGCTTACTGCAGCCTCAACCTTCTAGACTCAAGTGATCCTCCAGTCTTAGCCTCCCAAGTAGCTCGGACTACAGGTGTGCACTGCAACGTGTAGCTCATTTTTTTTTTAATTTTTAGTAGAGACAAAGTGTCACTATGTTGACCAGGTTGGTGGTGATCTCCTACCTCAGGCAGTTCTCTCACCTCAGCCTTCCAAAATGCTGGGATTACAGGTGTCAGCTGCCACACCTGGCTGAGGGGGTTAATTTTTAATTATATAAAGAGCTCAAAGCAAATATTAGAAGGAGCCTAAATGCCTCCAGCAGTTGACTGGTACTGGTAAATTGTGATACATCCATATAATAAAATATTATGCAACCATGAAAAGGATTAAGATAGATCAATAGGTATTGGCACAAATGTCCACGAAATATGAAAATATGAAGTGATGTTCAATCACCATGTACGTATCTTGAAGGATATAGCCCATTCTCAACTGCAATTATTTCCTGAGATAAGATTATGGGTCTAAAGTGAAGGACATTTTTCACTTATTTAAAAGTATTTATCATTTTTATAATTTGACAAGATTAAACAGATCATTGAATTAGTAAAAGACAAAGTAACTCTATAAATAAATGGAAAAGACACAGATACCCAGGCATGGTGGCTCATGCTTATAATACCAGTACTTTGGGAGGGGGTGGTGGGGGGATTGCTTGAGGCCAGGAGTTCCAGACCAGCCTAAGCTCAATAAGACCTCCTCTCTAGTAAAAATAAAAAATAAAAAATAATTGGCCAGGCATAGTGGCATGTGCCTATAGTCCCAACTACTGAGGTGGAAGGATCACCTGAGCCTAGGAGGTCAAGGCTGCAGTGGGTTGGTGCCACTACACTGAAGCCTAGGAGACAGAGCGAGACTTCATCTCAAAAAAAAAAAAAGGACAATAAAGAAATAAAAGCTAATAAACTAACATAAGGAAAGATAAAATATGTGACAAATAGGCTGGGCGGCACATGGCTGTAATCCAAGCACTTTGGGAGGCCAAGGCGGGTAGATCACGAGATCAGGAGTTCGAGACCAGCCTGATCAACATGGTGAAACCACGTTTCTACTAAAAATACAAAAATTAACCAGGCATGGTGGCATATGCCTGTAATCCCAGCTACTCAGGAGGCTGAGGCAGGAGAATCGCTTGAACCTGGGAGGCACAGGTTGCAGTAATTCGAGATCACACCACTGCACTCCAGCCTGGTCGACAGAGCGAGACTGTGTCTCAAAAAGAAAAAAGAATGGGTGACAAAGTAATAATAGGAGGTCTTTCATTTATCACACAGAAAATAACTTGTTAAATTGCAATACCTGTGTGGGCGAAGGTGCAGTGAAATGGCCATTTTCTTGTAGTATTAGTGGTGTTTAAAATGTATATAAACCTTCCAGCATAAAGCTTGAAATTTTTTTTAAATCATACAGACAGTGACTCATTATACTGCCTCCTCCAACTCCTGGCCTCAAGCAATCCTCCCACCTCAGCCTCCCAAAGTGCTGGAATTACAGGCGGCAGCCACCATGCCTGGCTTTGCAATTTACATCAGGGGTAATAAGAATGCTCATGCCCTGTGACTCACAGTAATCTGCTTCTGTTCACGCCTTTGGATATAATTCAACCTAAACAAAAGGTCGTATGCACAAACACAGTGAAAATCTGGGAATTATTTTTTCTCTTTTTTTAAAAAAATATGGAATGCTTCACAAATTTGCATGTCATTCTTTCACAGAGGCCGTGCCAATCTCTCTATTGTTCCAACTTAAGTATGTGTGTGCTACTGAGGCAAGCATAGGTAATTTAAGATAGAGTGGTTAAGTGAAATAAGGAAGAATTATGGAGAATTTAAAAATCTATGCTATTTATAGGCACCTAATGCTCAGTAAATATTAGCTGCTACTATTATTATTTTTATGGTAATTTCACTCAATTAAAAACTGTCGTTAAAAATTACCATTGTCATGGAACATAATGTCTCCTACTGTATAATTGTAGAAACAGATACAATTTGTCCCTTGGTATATGGGATTAGTTCCAGCTCTCATTTGTGTATACCAAATCTTTCTCAATTTGAAGTCAGTCCTGTGGAATCCACATACACAAATGGGAAAATTAGTGAGGTGTGGTGACAAGCACCTGTAGTCCCAGCTACTTGTGAGGCTGAGGCAGGAGGATTGCTTGAGCCCAGGAGGTTGAGGCTGCAGTGAGCCATAATTGCACCACTGCACTCCAGTCTGGGCAACAGAGTGAGACAGAAGGTTGACTTTTTAATAGAATTTTTCTGTTCACTTGAAGATATGGTCAGGATTGTGGCATGAAAATTCTTCATAAAATAACTATCTAATCCAATTAATGCTGGAATTGGGAACAGCAGAAGTGTCATCTCAGAGCTACTCACAATGAAAGGTGATGTCTGGGGCTCAGGTGTGTTGAGGTCCCCATGCCTGGACTATGGGTGCTGAGTGGGATTATGTCCATCCATTTCTATATTCCAGCACTGGGAAACCAGGGACAGTACTTGTTCTCAAGGGAATCTTCAGCTTAGATTGGCTCTGTAAAGAGGGAGTACATCATTTGAAAAATCGTCGCAGGTCAGGTGAGGTGGCTCATACCTATAATCCCAGCCCACTGGAGACTAAGGCAGGAGGATCAAGAGTTCAAGACCAGCCTGAGCAACACAGTGAAACCTCATCTCTACAAAAAATTAGAAAATGAACTGGGTGCGGTAAAACATTCGTATAGTCCCAGCTACTCTGGAGGCTGAAATAGGAGGATCGCTTGAGCCCAGGAAGTGGAAGCTGCAGTGAGCTCTGATCTCACCACTGCACTCTAGCCTTGGTGACAGAGTGAGACCCTGTCTCAAGACACACACACACACACACACACACACACCCAATCTCACTCTGTCCAGCCTTGACTAATCAAAAGGGCCTTCTGGTTACAGAAGAGGTATGCTCTTTTGTAGGACGGGGGAGAACCAGCAAGCTTGTTCACAGACTTTCCTCATCCTCTGCTTAGTTTTCCAAGAACCCTCACAGTGGAAATGGGTCTCTGGGAAAATGACCTAAATCTTTGGGTTACCAGGGGAGAAATATGCCTCCTTTGTCAATTAATAAATGGAACATCTGCCTTAAAATCCAGGGAGTTTCTGCTAGAATGAATCACTCCCTAAGACCCTGACCAATGCATGGAACATGAAAAACTGAAGTTTAACTGGGCGCGGTGGATCACGCCTCTGTAATCCCAGCACTTTGGGAGGCTGAGGCGGGCGGATCACCTGAGGTCAAAAGTTCTAGATCAGCCTGGCCAACATGGTGAAACCCCGTCTCTACTAAAAATACAAAAATTAGTTGGGCATGGTGGTGGACACCTGTAATCCCAGCTACTTGGGAGGCTGAGGCAGGAAAATCGCTTGAACCCGGAAGGCGGAGGTTGCAGTTACTTCTAGAAGAATTTCCATTAGCCCTTTGAAATCCTTCAACATTCATGAAGGCAAAAGGTTTTCACCTAATTTAATCTGATGGGTGTGTGACCCAGAGTCTTTCTAGGGAATGAGACTCCCAAACAGTTCGACTGGGAAGTGAGGAGAGAATTTATTACTCAAAACCAAAAGGGAAATGAAAAGAGGCCTTATAGAATGTCATTATTCTTTCTTGGCCGGGAATGGATTTCAGAGTCGTTGCGACCTTTACATGACCTCCTTATTAGCATCTAAAAGCTTCCAGTGTAGGATGCAGCCAGCTAGGTTCTCTTCTAATGTAATAAAATTTGCTTGACCAAATCTTATGCTGAAGCCATCTCCAGGCTCCAGAAACAATAGGCTATAAATTACTGGATCTCCCATTTGATACAATGAAGTATGAGCATGGTCCTGAATGACTCCTCTACATACTACTCTGGGTGGCTTGAAGTGAATTTGATACAAGAACTGGAGCGAGGGCAAAGCAGAGCTAGATCTAGGATTAATGTGCTTGTTGAACTCCTCACTACTCACCTATGAGTCTAGTTCCAGAACCCAAGTAGGATGGGAAACAAGGCTCCTGACTTTTTCCCTAATGTCTGCATCTCTTTCCCATTTCTTATCTCCTTGCAAAGAAACTAAACAGAGCTCAACTGAAATAACTAAATGATTAAACCCTATACAGAGACTCTCCAAAGACTGACAAAATATCATTCAAGACTGTTACACAGACAACCTTGAGGATGACTTGATGTACCAGTGATCTACAATATTTGGGATCATTCCAAATTCCCATCAAGGATCTGCCTATATCAACAAAGGAGCCAAGGACCAACCATTCAAATGGGCCATGCTGCCAAACCTTTTTTTTTTTTTAACAATGCCATCTCTTCATATTGTTCATTTAACAAAACTGCAGCCCTTCATCTATCCTTAAGTCCTTGGCCGTATTGGGGACGGTAATACTACTCCCTAGCAGGAAATCAACAGGATGACCTACTAAACACCATTCAGAAGATGCTAAGACCCATAGTGCAACAGGAAAGAAAAGACAGAGAATTAGTCAGACAGGTACATGCTGTGCCAAAAATGCACTACAGCCCCCAATTCTGCCTAATCCTAGCTGGGCTGACACCAACCTGATGAGACCGAAGACCTATAAGATCTCAAACTAAAACAGAAACTCTGAACTGGGTTCTTTCGACAGGAAGCAGCCAATAAATCATTAAAGAACAGATAAGTTCTTAAGGTGAGGAGAGTTTCAGATAAATGGAATGCTGGTAGAACACAGGGCCCAAAGGAGCAAAAGTTAACCTAAACCCAGGTAGAACCTTGTTTACTAGAGTATTAGGCATGGGTTTGGGCAACTATTCTAACCAGAGAAGCAGCTTCAGTGAGGGCAAGTTAGCAATCAAGGTATAGCATGCATGAGGCTGGCAAAATTCAGGGTGACTGAAGCAAAAGCTTCATAACCAGAAAGACCACATCTGGGGGTAGAGCACAAAACTCTCAAGATGAATCTTTGTAGAGTGAAGGCAGAACTATATAGCAGTTTAGGAGATCTGTTGGTGCCCAGCAAGAGCTCCAGCTGGGTATATGCAGGGATGCAGGCTGTGGTCTCAGGAGAGAGGTTCTAAAAGTCATTCAGTCCAAGACCTCAAACTGTGTTCTCTACTAAAAGGAATCAAGGTTCCCTAGAGAAATGGCTGACTCCATGTATGGTGCAGTATATTGATCCTGGAACATCTGTTTTGCCAAGCAAGGAAGCCATCAAAGTCCAACAGGATCACGTCAAAAAGACATGAAAGTCAACTTGAAGAGATAATTATTAACCTAGATGGAGACAATGTAAGCATCCAAAACAATAAAGACTGCAATGACACAAATACATCAAATGCAAACAATAATCTATGAGTTCATAATGGTATTCAGAAAAAAAAACTACTGGTCCATTAGAGGAAGGTTACTAGGTCGCAACACTACTCTGAAAAGTGACTTAAGATGAGAGGTAGGGTGGAGAATTAGCTATTTATTCAGTCTTTCCTGTACAAACATAAATTTTTAGGGAGATTGAAGCAGATGAAACAAATCTGGAAAAATGGAGGTAACTGCTTAATCTGCGGAGTTGGGTGCATGGAGGTTTAACATATTTCTTTTGTGTATATTTGAACCCCCTACAAAAAAAACACAAAGACAGAATGTGAGCCAAGCAGCTTAGGGTTTGACGACTGCCTACAAGAGACATAGGATGGGGTAGTTTTAGCCTAATGGGCTGAGCCAACTGGAGGTATATGAAGTACTAAATTGCAGAGGTATCATGTTGTACTTGATCAAATCCTAGATCCTAGGTCTGCTTGGTGGCATGCTTCCTAGGTAGTGGATACAAGGCTACCTATAGAACTGTGATGTATTCGCTCAGAAACTACAAAAGTGCTTGCTCTTGAAAATGGAGTCTTTGTCCATTCATGCTTCTATAAAAGAATACCACAGACTGCATAATTTATAAAAGGAAAAAGGAAGGAAAAGAAAAAAAGAGGAAGGGAGGAGGGAAGGGAGGAAAAAAGGAAGGAGGGAAGGAAAGGAAGGAAGGAAAGAAGGAAAGGAAGGAAGGAAAGAGAGAAAGAGGGAAGGAGGAAGGGAGGGAAGGAGGGAGGGAGGGAGAGAGAGAGAGGGAGGGAGGGAAGGGAAGAAAAGGAAGAGAAGGAAAGGAGGAAGAAAAGGAAAGGAAAGGAATAAATTTTGTTCTTAACAGTTCTGGATGTTAGAAGTCCAAGGTTGGGGAGCCTGCATCCTGGTGGGTCTTCTTGCTGCATCCATCCCACTACAGAAGGCAGAAGGAAAAGAGGTGCAAAAGCAAGGGCAAAGGGCTGAACTCTGTTTTATAATAGCCTCTGTGATTATAATCTGTTACCACAATAACAACATTAACTCATTCATGAAGGCTATTTTATTAGGCCCCACATCCCAACTGTTGCATTGAGGATTGGGTTTTCCAGCACATAAACTTTGGGGGACACATTTAAACCATAGCAGAGCACTTGGGTTAATTCAACTAAGAGGAGCTGGGAAAATCAAAGGCATGAGAAAGACAGCAAAAGCTAGCAGAGAGAAATGCATGAGTTGAAAAAAGTCACAGTGAATCCTGTAGTGCAGGCTACTTTATCAAAAGCACTAAAAAGATCTCATTAACTCCCCCAGCTCACACTCACGCACATCTAAAGAGCCACACACAGCACCACCAAAGGCAGCACAATGAGAACAGCATTCTCCTCAACAGACAAGCTGGGAGTATCTAGACACCTGACCTCAATAGCTCCAGTGGCTATTGTTCCTCCCTAACCACCACTCAAGTCACCAGCTTGGAAAGTAGTAGAAAACCCAAATTGACACACCACTATGAAACAACAAAACAGCAGAACAACCCATTTAAGCAATGCCAGCTGTTGGGAAAAAAGGAACAATGAGTAGAGAAGCAGACCTCTCAGGGGTCCACTAAGACCCAGTCTCGCAACCAGCACTTTTTAAATGCAGAATCCATACCCCTCAGGGCCTGTGGAGCTCCACAAGGCATGTCGTCCTCAAAGATAAATGAACGAGCAGCTGGCTAGAAAACCACTAAGGGTGTTATTCTTTAAAGAATCTTTATAGGGTCAAAGAAGAATGGGTCCTAACTGGCTATGTGAACTCCCCACAGATTCTGAGGATGATGTCAGTATCCCTTTCCAGATGTGTTTAACACTTTGCAGTCACTTGTATTCCTGCCACTGAGTGCCAGTGCTTTGCTAATTTGAACTGGTTCAACTCCATGACACAGCTCCTGGATGTTACCATTAGCCAGACTGACACCCATGCTGTACCCTTTCAAAAAGAGTCACAAACGTATTTCACCTACTCTTCCAAGACAAGTAAAAATGACTGCCAAAGAAATGGGGAAAAAAGGTCAGAGAGTGAAAACAGTGTATATAACAGACATGGGGAGAAACTAGGAAAATCATATATGGGCTCTCTGCAAAACCCACAGGCTATGTCCTTTTGCTTGTGTCTGAATGGAGCACCAATTTTAGCTGTGGCGAAAAAAAAGAAAAAGCAGGCCAGAGCTGGGCGCAGTGGCTCATGCCTGTAATCCCAGCACTTTGGGAGGCCGAGGCGGGTGGATCACCCAAGGTCAGGAGTTCTAGACCAGCCTGGTCAACATGGTGAAACACCATCTCTACTAAAAATACAAAAAATTAGCCAAGCATGGTGGCGCATGCCTGTAAATCCAGCTACTAAGGAAGCTGAGGCAGGAGAATTGCTTGAACCTGGAAGGCAGAGAATGTGGTGACCTGAGATACGTCATTGCCCTCAAGCCACAGCAATGAGAACAAAATTCGGTAAAAACAAAACAAAACAAAACAAAACAAAAACACATAAAAAATAACTCAGACTTAATTAAATACAACCTAGTGGTGAATGACTAAAGATGGATTACTCATAACAGAGATTGAACAGTCCAATAAGAATCCAGGAATCTTACCTTTTAATAACAAAAAAATCCTTTCCTTCTAAAGTAACATCCTCTCAAGGCCAGGAATTCCATTAGTAGAAAGCCTTCCTAAAAAACAAAATTCCTGGCCAGGCATGGGTTCACGTCTGTAATCTCAGCACTCTGGGAGGCCGAGGCGGGAAGATCCACTTGATATCAGGAGTCGAGGCGGGAAGATCACTTGACGTCAGGAGTTCGAGACTGGCCCAGCCAACATGGTGAAACCGCATCTCCACTAAAAATACAAAAATTAGCCTGGTGTGGTGGTGGGCACCTGTAATCCCAGTGACTTGGGAGGCTAAGGCAGGAGAATTTCTTGAACCCAGGAGGCAGAGGTTGCAGTGACAGCAAGGTTGCGCCATTGCACCCCAGCCTGGGCGATAAGAGTGAAACTCCATCTCAAAAAAAAAAAAAAAAAAAAAATTCCTTTGGGAAGGCCTTCTACATAAAAATCTTCAACATGAGACTGGAAAAGAGGTATGGGATCATCACCGGACCTTTGGCTTTTGCAGCTCGAGCTATAGAACAAAAAGAAAAGGGATATCATTTAAACACGGTATGTGAAAAGAATAATTATTGAATCTGTACTGGTCTTTAACTTTTACACTTTGATCTTCATTCTGTTATTGTGATTGAGTCCAAAGAAAAACAGTATGAGTAAAATAAAAAGAACACCAAAAATGCTAATATTCTGTTTGCAGAAGTCTGTAGTGAAATATCCCATTAAATCCAAGTGCAGTGGCACACCATAATCCCAAGCACTTTGGGAGGCTGAGGCAGGTGAATCTCCTGAAGTCAGGAGTTCAAGGCCAGCCTGGCCAACATGGTGAAACCCCAACTCTACTACAAATACAAAAATTAGGCAGGCGTGGTGGCAGAGGCCTTAATCCCAGCTACTTAGGAGGCTGAGGCAGGGAGAATTGCTTGAACCCAGGAGGTGAGCTTGCCATGAGCTGAGATCATACCACTGCACTCCAGCGTGGGTGACAGAACAAAACTTCAACCTCAAAAAAAAAAAAAAAAAAAAAACAGCTAGCAGGTGACATTTGCTATAGGGAGTGAGGAGACTAGGGATATGATCTTGCTGCAATCTTTCCATTTAGTAAATCTAAACAAGTGTGAATCCATTCTGTTTCGTCCCCATCGCCAGAGCCAAAACAAGAAAATCAATTATATTTCTAGTTCTTTAAAAACATATCTAACTAAATCATCTAATTAAAAGATAATATGCATGGTTCCATACTCTAAAAGAAAACTTATGTCCTGCATATCATGGACATTTGATGAATGCTTATTCAGTTGACTGGTGTAGACTTCAATAATAACCTGTTCAATGCATTATACCAGATGAATCTTGCATCTCAAAGTAGAACAAATATTGTTCTTTCAGTTTGTCTACCCATAAATGCAATATTTACTAATAAAAAAGAAAAATGAGTTTATTGTTCTAGAGAGTATGAGAATTTTGACAGCATGAATTCTCCTGTCCTAGGACATAATTAATACTAGAGGCATACTATTTCATGTGGAAGCTACCATTAAATCAATGTTAAGTGTTAATTACCTCACATAATCTTCTAATCGAGCTTGACTGAAGACGGTACCTGACAAAGTTGATTTATCAAGTTGTAAATCTTCACCTGTTGAATTCATAAGTTCATGTCTGAAAGGTGAATAAATACTTAATATTCATTAGGCAATATTCCTTAGTAATATCCACTAGTACATATTTAATATTTCATCATGAACTGCGGGTGTGAAGAAGAAAAGACAGGCTGGGCACAGTGGCTCACACCTGTAATCCCAGCAGTTTGGGAGGCCGAGGCAGGCAGATCATGAGGTCAGGAGTTCGAGACCAGCCTGGCCAACATGGTAAAAACCCCGTCTGTACTAAAAGTACAATAATTAGCTGGGCATGGTGGCAGGCACCTGTAATCCCAGCTACTCGGGAGGCTGAGGCAGGAGAATTGCCTGAACCCAGGAGGTGGAGGTTGCAGGAAACCATTGTCCGCCACTGCATTCCAGCCTGGGCAAGAGAGCAAGATTCTGTCTCCATCAATCAATCAATAAAAATATAAGGAGGGAAGCATTTACTGTGTATTTATATGTCTGGTATTATGTGAAGCACTTTTATCTTATCAAATCTTCGGGACAGATCTTCAGTTCTCATGACCACAAAAGAGGATACTAGTGAACAGGAGAAGGAACGTGGCCAACCTGTGTCCCCAGGACTGTGGTCTTACCACTAGGTTACAGTGTTTTCAGATATCACATGTTGTGGGGTGCCTTTAAAATGAACCAAAAAACCAAAGGTAGAAAAAGAGCTAAGCTATTAAAAAGTGGGAGAAACACTAAGAGAACCTTAAGCATGTAACTAAAAATATTATGGAAATGTTATTGAATTCATTATGGAAATTTTGGTACTAGGTTTTCATTGAGGAGTAGGTTATATTACTCATGATGAAGAAAAATGTTACATTTAAGTATATTAACATAAATACCATCAATATTGTTTATCATGCTTAAATGTTCACTTAAAGCAATTCAGTTAAAATTCTGCATATCATACAATTTTATAGTTTGCTAGTAGGTTACAAAGTAAATAGTCACCAAATAAAAACATCATGTTTTTCACGGTTGTTGCTCTTTTTTAGGTGGTATTTGATGTATACCAACAGAGAGGATAATAACAAATCGCTAATTTCTTTCATCACTATATAAAGGTGGCTTCAGGATAGAATAGTATCAGGGCAATGATGAATTTGAAATCTAACATCAATTCAGTGATGCATCAAGATAAAAGTAGAGACAGCAGGGGCTGTGGTGAGTACTGAACATTTTATTTATTTATTTATTTTGAGATGGAGTTTTGCTCTTTTGCCCAGGCTACAGTGCAATGGTGCCAACCTCGCCTCACTGCAACCTCTGCCTCCTGGGTTCAAGCGATTCTCCTGCCTTGGCCTCCCGAATAGCTGGGATTACAGACATGCGCCACCACACCGTCTAATTTTGTATTTTTAGTAGAGACGGGGTTTCTCCATGTTGGTCAGGCTGGTCTCGAACTCCCGACCTAGATATCTGCCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGTGTGCCCCTTATGGTCGTTAAATTTAACAAGCAGACTAAGAGAAACAATTCATTTAAAAAAATAATATTTGGCCAGGCATGGTGGCTCACACCTATAATCCCAGCACTTTGGGAGGCTGAGGTGAGTGGATCAGGAGGTCAGCAGTTCAAGACCAGCCTAGCCAAGATCATGAAACCCCGTCTCTACTAAAAATACAAAAATCAGCCAGGCGTGGTGGCGGGTGCCTGTAATCCTAGCTGCTCGGGAGGCTGAGGCAGAGAACTGCTTGAACCCGGGAGGCGGAGGTTGCAGTGAGCCGAGATCGTGCCACTGCACTCCAGCCTGGGTGACAGAGTGAGGCTCCGTCTCAAAAAAATAAATAAATAATTCAATGAAATTCCTAAGATCCAGGGCTTTGCAATAAATATGTAAATAAATTTCAATCTCCATACTGAAAGTTTAAAAGAAATGCTAACTAATAACTAAAGAAATACAACTTTTCTCCAGCTTTGCAGCAATCTAGAAACAAAGTGTGTAGACACTACAAAGCACCTTACAAGGAGAAACATGTAAGGATGGCATGACTCACCGGCGGCCTGAGCATCCACGGTACCCCCATGATGAACAGTAACTCCACTGTGTAAGCATGAACATAAGATTACAAGACTTTTCAGTTTAGACATACCATATTTTCTTTCAGACAATTCTTCAGTTTGTTTACGTAGATCAGCGATACGATGATTCCATTTCTCTGAAAACCAAGCAAAAGTTGCTTCTCAATAACACGTCCCTATGTCAGAGCAGCACTAACGTATAATGACTGATTTCATATATTTTACATTCTAACAGTCCATATCCACACTGCTTTCAAGAAAAAGACTTGCTCTTGGTGGTTCTTAGAATTGGTTTAATGGGAGACTATTAGAGAAGCTGAAAAGCAGGAGGGCAGAAAAGTTCAATCAAATTAAACACAATAACAGGGAGGTCACAATGAGGCGGTCTCCAGGGGTCTTTTAGCAAACTTCTAAAACATGTCTCAGCTGTGTGAAATAAGACTTTACAGCAGCCGGGTGCAGTGGTGCAGGCCTGTAATCCCAGCACTTTGGCAGCAGAGGCAGGCGGATCACTTTGAGCTCAGGGCAACATGGCCAAAACCCCCCCTCCCTAGCCCCACCCACCCCGTCCCTACCAAAAATACAAAACAGCAGGGCATGGTGGCGGGCGCCTGTAGTCCCAGCTACTCAGGAGGCTGAGGCAGGAGAATCACCTGAACCCAGGAGGCAGACATTGCAGTGAGCCAAGATCACGCCACTGCCAGCCTGGATGACAGAGCAAGACTCCACCTCAAAAAAAAACAAAAACAAAAACACAAGGTTAGAGGGACCCCCGACCTTACAGATACAAGTTTAAGAGGGACCCCAAGCAAAAAATGCCAACCTTTTTCTCCCAATCATTGAAACACCAGGAGGGTGTAACAGTTTTGCAGCCTAGCTGTAGCAGGCTGATGCCCCCAAGATGCCCCATATCCTAATCCCGGGAACTGGTGAACATGACCTTATATGGCAAAAGGAGCTTTGCAGATATAATGAAGTTAAGGGTCTTTGGCTTTTTGGGGTTGATGTACTCACTCGGATCCTTGTAAGAGCAAGAGCAGGTGATGGAGAGGGTGGGAGGTGTAGTGACAGAAGCAGGAAACTCAGTCATTCGAGACGGGCAGCACAAGCTGAGGGAGTGCAGGCCACCTCTCTGACCAGAAGTGGATTCTCCCGCAAGCCTCGGAAGCTACCGACCCTGCTCCCACCTTGACTCAGTAGGACTTACTGTAGAATTCTGGCCTTCAGACCTGTAAGGGAATACATTTGGTTGTTTTAAGTCATAGTGTGTGGTAATTTGTTGCAGCAGCCACAGGAAACTAGTATTGTAGTGAAGCCTCAAAACCCCCCTGAAGGGGCTGGGCTCAGTGGCTCATGCCTGTAATCCCAGCACTTTGGGAGGCCGACGTGGGTGGATCACTTGAGGTCAGGAGTTCGAGACCAGCCCAGCCAACATGGTGAAATGCCATCTATACAAAAAATACAAAAACTAGCCGGGCATGGTGGCACATGCCTGTAATCTCAGCTACTCAGGAGGCTGAGACAGGAGAATTGTTTGAACCCAGGGGGCAGAGGTTGCAGTGAACTGAGATTCCACCACTGCACTCCAGCCTGGGTGACAGAGCGACGCTCCATCTCGAAAACAAAACAAAACAAAAAACCCCACCTGAAGGTTTCCAGTTCTGCCAGCACTCTCACCCAACCCCCAGAAACAGACATTCCATTGCTGTGGGCCATGGACAGGCAGAAGGAAGCACCTCCTCATGGCAGAGGCCTGGGAAAGCAAGGGAAGGCACTACTGGGCTGGCCCCTCTCTGCAGTATATTCTTTTTTTTGAGGCCGAGTTTCACTCTCTGTCTCCCAGACTGGAGTGCAGGGGCACAATCTCGGCTCACTTCGACCTCTGCCTCCCCAGTTCAAGTGATTCTCCTGCCTCAGTCTCCTGAGTAGCTGGGATGACAGGAGTGTAGCATGCCTAGCTAATTTTTGTATTTCTAGTAGAGATGCAGTTTTGCCATGTTGCCCAGGCTGGACTCGAACTCCTTGCCTCAAGTGATCCACCTGTCTCAGCCCCGCAAAGTGCTGGTATTACAGGAGTGAGCCACTGCACCCAGCATTTGCCAGAAGACCTTTGATGGCAGGCTTTTTTCAGGTGATCAGTCCTTGTCTGGTCTGGCTCTGCCCCACTCTCCCTTCTCACCTAGTTGGAATCCCTAGCTACTTTTCAGTAGAGGGAAGTGTGTACCCCAATCCCAGCTTGGTTCAGATCTGCATTTAACTCATGGAACCTGGCTGCTCCCCAGGTTCTGAAGAAAAAAACGGTCTCTCTGTGGGTATGATAAAGGATGGGCCTGTCCCCAGGACCCTGTGAGAGGAAGCCCAATGTCCCACCAGGTTGGCAGGGCTGGGGAAGGGAAAGTGTTATGGCAGCCCCAAGAAAAAAGAGGCAGCAGAGGGAGCAGGACAGCGCTCACATGGAACTCATGCCACTGCCTGAGGGGGAGGAGTGCACGCCAGTGACGTCAGGGGGCAGAGAGGCGCAGTTCCA"

trim_offset = int(paf_fields[2])
start_index = 0
end_index = int(paf_fields[3])

# prepare some data
x = [0, 1, 2, 3, 4, 5]
Xreal = [0, 1, 2, 3, 4, 5]
y = [6, 7, 2, 4, 5]

# set output to static HTML file
output_file(filename=args.output, title=read_id)

plot_title = f'{read_id}:{start_index}-{end_index}-{trim_offset}'
tools_to_show = 'hover,box_zoom,pan,save,wheel_zoom'
p = figure(title=plot_title,
           x_axis_label='signal index',
           y_axis_label='signal value',
           sizing_mode="stretch_width",
           height=300,
           output_backend="webgl",
           x_range=(0, 750),
           tools=tools_to_show)
# tooltips=tool_tips)

# open file
s5 = pyslow5.Open(args.slow5, 'r')
read = s5.get_read(read_id, pA=True, aux=["read_number", "start_mux"])
if read is not None:
    # print("read_id:", read['read_id'])
    # print("len_raw_signal:", read['len_raw_signal'])
    # x = list(range(1,read['len_raw_signal']+1))
    # y = read['signal']
    x = list(range(0, end_index - start_index))
    Xreal = list(range(start_index, end_index))
    y = read['signal'][start_index:end_index]

base_x = []
base_y = []
base_label = []

moves_string = paf_fields[14]
moves_string = re.sub('ss:Z:', '', moves_string)
moves_string = re.sub('D', 'D,', moves_string)
moves_string = re.sub('I', 'I,', moves_string)
# print(moves_string)
moves = re.split(r',+', moves_string)
moves = moves[:-1]

vlines = []
base_count = KMER_LENGTH - 2
location = trim_offset
previous_location = start_index
# draw moves

signal_x = []
signal_y = []

for i in moves:
    previous_location = location
    n_samples = 0
    if 'D' in i:
        i = re.sub('D', '', i)
        n_samples = int(i)
        prev_loc = previous_location
        for j in range(0, n_samples):
            base_count = base_count + 1
            base = basecalled_read[base_count]
            base_box = BoxAnnotation(left=prev_loc, right=prev_loc+5, fill_alpha=0.2, fill_color='white')
            p.add_layout(base_box)

            base_x.append(prev_loc)
            base_y.append(115)
            label = str(base) + "\t" + str(base_count + 1)
            base_label.append(label)

            prev_loc = prev_loc + 5
            x_end = x[-1]
            x = x + list(range(x_end, x_end+5))
        location = prev_loc
        z = np.concatenate((y[:previous_location], [0] * n_samples * 5), axis=0)
        y = np.concatenate((z, y[previous_location:]), axis=0)
        # y = y[:previous_location] + y[previous_location:]

    elif 'I' in i:
        i = re.sub('I', '', i)
        n_samples = int(i)
        location = location + n_samples

        vline = Span(location=location, dimension='height', line_color='red', line_width=1)
        vlines.append(vline)

    else:
        base_count = base_count + 1
        n_samples = int(i)
        location = location + n_samples

        base = basecalled_read[base_count]
        base_box = BoxAnnotation(left=previous_location, right=location, fill_alpha=0.2, fill_color=base_color_map[base])
        p.add_layout(base_box)

        vline = Span(location=location, dimension='height', line_color='red', line_width=1)
        vlines.append(vline)

        base_x.append(previous_location)
        base_y.append(115)
        label = str(base) + "\t" + str(base_count + 1)
        base_label.append(label)

    if base_count == BASE_LIMIT: break

p.renderers.extend(vlines)

base_annotation = ColumnDataSource(data=dict(base_x=base_x,
                                             base_y=base_y,
                                             base_label=base_label))

base_annotation_labels = LabelSet(x='base_x', y='base_y', text='base_label',
                                  x_offset=5, y_offset=5, source=base_annotation, render_mode='canvas',
                                  text_font_size="7pt")

p.add_layout(base_annotation_labels)

plot_signal_limit = location + 10

source = ColumnDataSource(data=dict(
    x=x[:plot_signal_limit],
    y=y[:plot_signal_limit],
    xreal=Xreal[:plot_signal_limit],
))
p.line('x', 'y', line_width=2, source=source)
# add a circle renderer with a size, color, and alpha
p.circle(x[:plot_signal_limit], y[:plot_signal_limit], size=2, color="red", alpha=0.5)

# show the tooltip
hover = p.select(dict(type=HoverTool))
hover.tooltips = [("x", "@xreal"), ("y", "$y")]
hover.mode = 'mouse'

save(p)
# show(p)
